Macro.add("tabs",{skipArgs:!1,tags:null,handler:function(){const a=$("<div class='tabs-tabset'>"),b=$("<div class='tabs-tabs'>"),c=$("<div class='tabs-contents'>");let d="",e=!1,f=0,g="left";for(const b of this.args)["left","right","top","stacked","wrapped","responsive-left","responsive-right","responsive-stacked","responsive-wrapped"].includes(b)?"responsive"==b.substring(0,10)?(e=!0,g=b.substring(11)):a.addClass(b):parseInt(b)?f=parseInt(b):(d=this.args[0]+"-",a.attr("id",this.args[0]));if(this.context={selected:0,tabs:[],contents:[],tabCount:0,wrapper:a,prefix:d},$.wiki(this.payload[0].contents),this.context.tabs[this.context.selected].addClass("selected"),this.context.contents[this.context.selected].removeClass("hidden"),b.append(...this.context.tabs),c.append(...this.context.contents),a.attr("style",`--cols:${this.context.tabCount}`).append(b,c),$(this.output).append(a),e){const b=new ResizeObserver(b=>{window.requestAnimationFrame(()=>{let c=b[0],d=0;d=c.contentBoxSize?c.contentBoxSize[0].inlineSize:c.contentRect.width,$("#out").html("comparing "+d+" with "+f+" to set "+g),d&&d<=f?a.addClass(g):a.removeClass(g)})});b.observe(a[0])}}}),Macro.add("tab",{skipArgs:!1,tags:null,handler:function(){const a=this.contextSelect(a=>"tabs"===a.name);if(!a)return this.error("must only be used in conjunction with its parent macro <<tabs>>");let b=this.args[0],c="tabs-contents-"+b.trim().toLowerCase().replace(/[^a-z0-9]/g,"").replace(/\s+/g,"-"),d=`<span>${b}</span>`;this.args[1]&&"string"==typeof this.args[1]&&(d=`<img src="${this.args[1]}">`);let e=$(`<button id="${c}-control">${d}</button>`).ariaClick(function(){$(a.context.wrapper).children(".tabs-tabs").children("button").removeClass("selected"),$(a.context.wrapper).children(".tabs-contents").children(".tabs-content").addClass("hidden"),$(a.context.wrapper).find(`#${a.context.prefix}${c}`).removeClass("hidden"),$(this).addClass("selected")});a.context.tabs.push(e),a.context.contents.push($(`<div class="tabs-content hidden" id="${a.context.prefix}${c}">`).wiki(this.payload[0].contents.trim())),1<this.args.length&&!0===this.args[this.args.length-1]&&(a.context.selected=a.context.tabCount),a.context.tabCount++}});